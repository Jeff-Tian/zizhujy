(function($){var classes=null;var surface=null;var theLayer="";var theFont="";function processCoordinates(plot,canvascontext){var handlers={"default":function(plot,ctx){setAxesVisibility(plot,true);surface=new classes.Canvas("flot-base",plot.getPlaceholder());handleRatioXY(plot);drawAxiesAndArrows(plot,ctx);$(".flot-text").show()},rectangular:function(plot,ctx){function measureTickLabels(axis){var opts=axis.options,ticks=axis.ticks||[];var axisw=opts.labelWidth||0,axish=opts.labelHeight||0;var legacyStyles=axis.direction+"Axis "+axis.direction+axis.n+"Axis";var layer="flot-"+axis.direction+"-axis flot-"+axis.direction+axis.n+"-axis "+legacyStyles;var font=opts.font||"flot-tick-label tickLabel";for(var i=0;i<ticks.length;++i){var t=ticks[i];if(!t.label)continue;var info=surface.getTextInfo(layer,t.label,font);if(opts.labelWidth==null)axisw=Math.max(axisw,info.width);if(opts.labelHeight==null)axish=Math.max(axish,info.height)}axis.labelWidth=Math.ceil(axisw);axis.labelHeight=Math.ceil(axish);theLayer=layer;theFont=font}function floorInBase(n,base){return base*Math.floor(n/base)}function tickGenerator(axis){var opts=axis.options;var noTicks;if(typeof opts.ticks=="number"&&opts.ticks>0)noTicks=opts.ticks;else noTicks=0.3*Math.sqrt(axis.direction=="x"?surface.width:surface.height);var delta=(axis.max-axis.min)/noTicks;var dec=-Math.floor(Math.log(delta)/Math.LN10);var maxDec=opts.tickDecimals;if(maxDec!=null&&dec>maxDec){dec=maxDec}var magn=Math.pow(10,-dec);var norm=delta/magn;var size;if(norm<1.5){size=1}else if(norm<3){size=2;if(norm>2.25&&(maxDec==null||dec+1<=maxDec)){size=2.5;++dec}}else if(norm<7.5){size=5}else{size=10}size*=magn;if(opts.minTickSize!=null&&size<opts.minTickSize){size=opts.minTickSize}axis.delta=delta;axis.tickDecimals=Math.max(0,maxDec!=null?maxDec:dec);axis.tickSize=opts.tickSize||size;if(opts.mode=="time"&&!axis.tickGenerator){throw new Error("Time mode requires the flot.time plugin.");}var ticks=[],start=floorInBase(axis.min,axis.tickSize),i=0,v=Number.NaN,prev;do{prev=v;v=start+i*axis.tickSize;ticks.push({v:v,label:v});++i}while(v<axis.max&&v!=prev);measureTickLabels(axis);return ticks}function drawAxisTicksAndLabels(plot,ctx,axis){axis.ticks=tickGenerator(axis);ctx.save();var offset=plot.getPlotOffset();ctx.translate(offset.left,offset.top);var origin=plot.p2c({x:0,y:0});ctx.textAlign="end";ctx.textBaseline="middle";if(!!axis.ticks&&!!axis.ticks.length){for(var i=0;i<axis.ticks.length;i++){var tick=axis.ticks[i];if(tick.v<axis.min||tick.v>axis.max){continue}var aPos=axis.p2c(tick.v);var xFrom=0;var xTo=0;var yFrom=0;var yTo=0;if(axis.direction=="x"){xFrom=aPos;xTo=xFrom;yFrom=0;yTo=plot.height()}else{xFrom=0;xTo=plot.width();yFrom=aPos;yTo=yFrom}if(tick.v!="0"){ctx.beginPath();ctx.strokeStyle=axis.options.tickColor;ctx.moveTo(xFrom,yFrom);ctx.lineTo(xTo,yTo);ctx.stroke()}if(typeof tick.label!="undefined"){var labelWidth=axis.labelWidth;var labelHeight=axis.labelHeight;if(!!theLayer&&!!theFont){var info=surface.getTextInfo(theLayer,tick.label,theFont);labelWidth=info.width;labelHeight=info.height}var x=0;var y=0;if(axis.direction=="x"){if(tick.label!="0"){x=aPos+labelWidth/2;y=origin.top+labelHeight/2}else{continue}}else{if(tick.label!="0"){x=origin.left-labelWidth/2;y=aPos}else{x=origin.left-labelWidth/2;y=aPos+labelHeight/2}}ctx.fillStyle=options.grid.borderColor;ctx.strokeStyle=options.grid.borderColor;ctx.beginPath();ctx.fillText(tick.label,x,y);ctx.stroke()}}}ctx.restore()}setAxesVisibility(plot,false);var options=plot.getOptions();var axes=plot.getAxes();var xaxis=axes.xaxis;var yaxis=axes.yaxis;if(typeof options!="undefined"){if(typeof xaxis.min!="undefined")options.xaxis.min=xaxis.min;if(typeof xaxis.max!="undefined")options.xaxis.max=xaxis.max;if(typeof yaxis.min!="undefined")options.yaxis.min=yaxis.min;if(typeof yaxis.max!="undefined")options.yaxis.max=yaxis.max}$.extend(true,options.xaxis,{min:xaxis.min,max:xaxis.max});$.extend(true,options.yaxis,{min:yaxis.min,max:yaxis.max});$.extend(true,xaxis,options.xaxis);$.extend(true,yaxis,options.yaxis);xaxis.used=true;yaxis.used=true;handleRatioXY(plot);surface=new classes.Canvas("flot-coordinate",plot.getPlaceholder());$(".flot-coordinate").remove().insertBefore($(".flot-overlay"));ctx.save();ctx.strokeStyle=options.grid.borderColor;ctx.lineWidth=1;var plotOffset=plot.getPlotOffset();ctx.translate(plotOffset.left,plotOffset.top);ctx.beginPath();ctx.moveTo(xaxis.p2c(xaxis.min),yaxis.p2c(0));ctx.lineTo(xaxis.p2c(xaxis.max),yaxis.p2c(0));ctx.stroke();ctx.moveTo(xaxis.p2c(0),yaxis.p2c(yaxis.min));ctx.lineTo(xaxis.p2c(0),yaxis.p2c(yaxis.max));ctx.stroke();ctx.restore();drawAxisTicksAndLabels(plot,ctx,xaxis);drawAxisTicksAndLabels(plot,ctx,yaxis)},auto:function(plot,ctx){var axes=plot.getAxes();var xaxis=axes.xaxis;var yaxis=axes.yaxis;if(xaxis.min<=0&&xaxis.max>=0&&yaxis.min<=0&&yaxis.max>=0){this["rectangular"]&&this.rectangular(plot,ctx)}else{this["default"]&&this["default"](plot,ctx)}}};var options=plot.getOptions();var coords=options.coordinate.type.split("|");var $flotText=$(".flot-text");$flotText.hide();for(var i=0;i<coords.length;i++){var s=coords[i];if(handlers[s]){handlers[s](plot,canvascontext,$flotText)}}}function setAxesVisibility(plot,show){var options=plot.getOptions();var xaxes=plot.getXAxes();var yaxes=plot.getYAxes();$.each(xaxes,function(index,xaxis){xaxis.show=show;xaxis.reserveSpace=show;xaxis.options.show=show;xaxis.options.reserveSpace=show});$.each(yaxes,function(index,yaxis){yaxis.show=show;yaxis.reserveSpace=show;yaxis.options.show=show;yaxis.options.reserveSpace=show})}function handleRatioXY(plot){var options=plot.getOptions();var axes=plot.getAxes();var xaxis=axes.xaxis;var yaxis=axes.yaxis;if(options.coordinate.ratioXY){$.extend(true,xaxis.options,{min:xaxis.min,max:xaxis.max});$.extend(true,yaxis.options,{min:yaxis.min,max:yaxis.max});var ratio=parseFloat(options.coordinate.ratioXY);xaxis.options=xaxis.options||{};if(!xaxis.options.max)xaxis.options.max=(xaxis.max||10);if(!xaxis.options.min)xaxis.options.min=(xaxis.min||-10);var deltaX=xaxis.options.max-xaxis.options.min;var deltaY=deltaX/(ratio*plot.width()/plot.height());yaxis.options=yaxis.options||{};if(!yaxis.options.max)yaxis.options.max=(yaxis.max||10);if(!yaxis.options.min)yaxis.options.min=(yaxis.min||-10);var r=(yaxis.options.max-yaxis.options.min)/deltaY;yaxis.options.max=yaxis.options.max/r;yaxis.options.min=yaxis.options.min/r;$.extend(true,options,{xaxis:{options:{min:xaxis.options.min,max:xaxis.options.max}},yaxis:{options:{min:yaxis.options.min,max:yaxis.options.max}}});plot.setupGrid()}}function drawAxiesAndArrows(plot,args){var options=plot.getOptions();var axes=plot.getAxes();var xaxis=axes.xaxis;var yaxis=axes.yaxis;var ctx=plot.getCanvas().getContext("2d");ctx.save();ctx.strokeStyle=options.grid.borderColor;ctx.lineWidth=1;var plotOffset=plot.getPlotOffset();ctx.translate(plotOffset.left,plotOffset.top);ctx.beginPath();ctx.moveTo(xaxis.p2c(xaxis.min)-1,yaxis.p2c(yaxis.min));ctx.lineTo(xaxis.p2c(xaxis.max),yaxis.p2c(yaxis.min));ctx.closePath();ctx.stroke();ctx.beginPath();ctx.moveTo(xaxis.p2c(xaxis.min),yaxis.p2c(yaxis.min)-1);ctx.lineTo(xaxis.p2c(xaxis.min),yaxis.p2c(yaxis.max));ctx.closePath();ctx.stroke();ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(xaxis.p2c(xaxis.max)+1,yaxis.p2c(yaxis.min));ctx.lineTo(xaxis.p2c(xaxis.max)+1-15,yaxis.p2c(yaxis.min)-7);ctx.lineTo(xaxis.p2c(xaxis.max)+1-10,yaxis.p2c(yaxis.min));ctx.lineTo(xaxis.p2c(xaxis.max)+1-15,yaxis.p2c(yaxis.min)+7);ctx.lineTo(xaxis.p2c(xaxis.max)+1,yaxis.p2c(yaxis.min));ctx.closePath();ctx.fillStyle=options.grid.borderColor;ctx.fill();ctx.beginPath();ctx.moveTo(xaxis.p2c(xaxis.min),yaxis.p2c(yaxis.max)-1);ctx.lineTo(xaxis.p2c(xaxis.min)-7,yaxis.p2c(yaxis.max)-1+15);ctx.lineTo(xaxis.p2c(xaxis.min),yaxis.p2c(yaxis.max)-1+10);ctx.lineTo(xaxis.p2c(xaxis.min)+7,yaxis.p2c(yaxis.max)-1+15);ctx.lineTo(xaxis.p2c(xaxis.min),yaxis.p2c(yaxis.max)-1);ctx.closePath();ctx.fillStyle=options.grid.borderColor;ctx.fill();ctx.restore()}function init(plot,theClasses){classes=theClasses;plot.hooks.drawBackground.push(processCoordinates);plot.hooks.bindEvents.push(function(){var options=plot.getOptions();if(!!options.xaxis.highlightTick&&!!options.xaxis.highlightColor){$(".flot-x-axis ."+options.xaxis.highlightTick).css({color:options.xaxis.highlightColor})}if(!!options.yaxis.highlightTick&&!!options.yaxis.highlightColor){$(".flot-y-axis ."+options.yaxis.highlightTick).css({color:options.yaxis.highlightColor})}$(".flot-text").filter(function(){return $(this).text()===""}).remove()})}var options={coordinate:{type:'default'},xaxis:{tickFormatter:function(v,axis){return v}},yaxis:{tickFormatter:function(v,axis){return v}}};$.plot.plugins.push({init:init,options:options,name:'coordinate',version:'1.6'})})(jQuery)